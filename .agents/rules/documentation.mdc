---
description: Documentation standards and rules for contract and API documentation
globs: ["*.sol", "*.md", "docs/**/*"]
alwaysApply: true
---

# Documentation Standards

## Documentation Style
- Use Canadian spelling and usage
- Keep documentation professional but approachable
- Write documentation so it is useful for the purpose of external developers who want to understand our tools. Documentation only of interest to Berachain internal developers should be excluded.
- Follow formatting conventions in [STYLE_GUIDE.md](../../STYLE_GUIDE.md)
- Significant changes require an entry in the [user-facing changelog](../../apps/core/content/learn/changelog.md)

### Source of Truth
- Interface files (*.I.sol) are the definitive source for:
  - Struct definitions
  - Function signatures
  - Events
- Implementation files are authoritative for NatSpec documentation
- Interface definitions take precedence in any conflicts

### ABI Updates
- ABI files are published in the [berachain/abis](https://github.com/berachain/abis) repository, organized by network (`mainnet/`, `bepolia/`).
- To update ABI references in documentation, update the links in `packages/config/constants.json`.
- This is a separate process from updating the autodocs.

### ABI References in constants.json
- ABI references must be verifiable and semantically accurate. Each ABI URL must return HTTP 200; broken links are unacceptable.
- The referenced ABI must correspond to the actual contractâ€”do not use placeholder ABIs or link semantically unrelated contracts (e.g., linking bridged WETH to WBERA.json is incorrect even if interfaces overlap).
- When a contract lacks a published ABI in the canonical repository, leave the abi field empty rather than substituting an approximate match.
- For third-party contracts (Safe, Permit2, etc.), reference the upstream maintainer's official ABI source rather than duplicating or approximating.
- Before committing ABI changes, verify all URLs programmatically and confirm path accuracy against the source repository's actual file structure.

### Git Source Links
- All Git Source links in documentation MUST point to the public contracts repository at github.com:berachain/contracts/

### Autodoc generation
The user can request to "refresh the autodocs". This means the following sequence.
- Check out a copy of the [berachain/contracts](https://github.com/berachain/contracts) repository.
- Use `forge doc` to generate contract documentation markdown.
- Extract the documentation from the markdown and replace the body of the corresponding file in this repository, applying the following rules as you copy the markdown. Repeat this process for every file generated by `forge doc`.
  - Exclude `supportsInterface` functions (ERC-165) from documentation.
  - Omit documentation for:
    - Private constants, variables, and functions
    - Internal constants, variables, and functions 
    - Functions intended for subclasses
    - Public virtual functions (except for RewardVault which is meant to be inherited)
  - Omit all Inherits lines
  - Exclude factory-only functions (functions that are only meant to be called by factory contracts)
  - Include governance-only contract functions since the chain uses on-chain governance

- Every file in the documentation autodocs should have a preamble like this at the top. In the preamble, the key to look up within config.contracts depends on the contract itself. Ask if you aren't sure which to use. You can update the ABI link in `packages/config/constants.json` if you find a new ABI in the [abis repository](https://github.com/berachain/abis). For the Git Source link, link to the contract under the github.com:berachain/contracts/ repository. 

```
> <small><a target="_blank" :href="config.websites.berascan.url + 'address/' + config.contracts.pol.berachef['mainnet-address']">{{config.contracts.pol.berachef['mainnet-address']}}</a><span v-if="config.contracts.pol.berachef.abi">&nbsp;|&nbsp;<a target="_blank" :href="config.contracts.pol.berachef.abi">ABI JSON</a></span></small>

[Git Source](https://github.com/berachain/contracts/blob/main/src/pol/rewards/BeraChef.sol)
```

- Contract documentation pages should be organized into the following order:
   - Constants
   - State Variables (public state variables)
   - Structs (structures used in state variables)
   - View Functions (public view functions)
   - Functions (public state-changing functions)
   - Events
   - Errors
- Use alphabetical sorting order for the names of functions, state variables, constants, and events.
- Group functions by type rather than by inheritance - organize by function type (view vs state-changing) rather than organizing by inheritance
- Keep documentation concise - avoid adding integration examples, security considerations, related contracts, or resources sections unless specifically requested
- Focus on pure contract reference documentation

### Validation Requirements
- Struct definitions and function calls must exactly match solidity code:
  - Names
  - Types
  - Order
- Include type information in struct descriptions

### File Management
- Seek permission before creating new files
- Keep READMEs current
- Respect pnpm workspace in guides/exp
- Use loose version numbers for minor upgrades
- Ensure any new files are inserted into the relevant sidebar file
- When cloning the contracts repository, do not use recursive clone (--recursive flag)
- Use git operations instead of recalculating patches and let the user handle the commit
